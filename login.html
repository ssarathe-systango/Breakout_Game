<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Login Form</title>
  <link rel="stylesheet" href="loginUpdated.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
</head>


<body class="loginbody">

  <div class="login-box">
    <h1>Login</h1>
    <div class="textbox">
      <i class="fas fa-user"></i>
      <div class="text">
        <input type="text" id="uname" placeholder="Nickname" required>
      </div>

      <div class="textbox">
        <i class="fas fa-lock"></i>
        <input type="password" id="pass" placeholder="Password" required>
      </div>

      <div class="signup_link">
        <button id="click" onclick="Authentication()" class="btn">Login</button>
      </div>

      <div class="signup_link">
        Not a member? <a href="index.html">Signup</a>
      </div>
    </div>
  </div>
  <!-- ------------------------------------------------------------------------------------------------------------------------- -->
  <script src="https://www.gstatic.com/firebasejs/4.8.1/firebase.js"> </script>

  <script>

    //-------------------------------------------------- Firebase Configuration --------------------------------------------------->
    const firebaseConfig = {
      apiKey: "AIzaSyDzBeh1scj-vECh-Rh2dQnLSf5O3XyTrGA",
      authDomain: "breakout-game-3710f.firebaseapp.com",
      databaseURL: "https://breakout-game-3710f-default-rtdb.firebaseio.com",
      projectId: "breakout-game-3710f",
      storageBucket: "breakout-game-3710f.appspot.com",
      messagingSenderId: "602197715891",
      appId: "1:602197715891:web:5b01f760950f470c4ef9c6"
    };


    //------------------------------------------------------ Initialization of Firebase ------------------------------------------------>

    const app = firebase.initializeApp(firebaseConfig);

    // import { getDatabase, ref, get, set, child, update, remove }
    //   from "https://www.gstatic.com/firebasejs/4.8.1/firebase-database.js";

    const db = firebase.database();


    function Authentication() {
      let Username = document.getElementById('uname').value.trim();
      let Password = document.getElementById('pass').value;

      db.ref('Registered Users').once('value')
        .then(function (snapshot) {
          // var count = 0;
          var flag = false;

          snapshot.forEach((item) => {
            // console.log(item);
            // var flag = false;
            uname = item.val().uname;
            pass = item.val().pass;
            // console.log(uname);
            // console.log(pass);
            // console.log(Username, Password, uname, pass);
            // console.log(uname === Username && pass === Password);

            if (uname === Username && pass === Password) {
              flag = true;
              localStorage.setItem("user_name", uname);

              window.location = "home.html";
            }

          });

          if (flag === false) {
            alert("Invalid Username Or Password!");
          }
        })
        .catch((error) => {
          console.log(error);
          return false;
        });

    }
    function login(user) {
      window.location = "home.html";
    }


  </script>
</body>

</html>